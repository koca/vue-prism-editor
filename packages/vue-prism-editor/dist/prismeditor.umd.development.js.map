{"version":3,"file":"prismeditor.umd.development.js","sources":["../src/Editor.ts"],"sourcesContent":["import Vue, { VNode } from 'vue';\r\n\r\nimport './styles.css';\r\nconst KEYCODE_ENTER = 13;\r\nconst KEYCODE_TAB = 9;\r\nconst KEYCODE_BACKSPACE = 8;\r\nconst KEYCODE_Y = 89;\r\nconst KEYCODE_Z = 90;\r\nconst KEYCODE_M = 77;\r\nconst KEYCODE_ESCAPE = 27;\r\n\r\nconst BRACKET_PAIRS: {[opening: string]: string} = {\r\n  '(':')',\r\n  '{':'}',\r\n  '[':']',\r\n  '\"':'\"',\r\n  \"'\":\"'\",\r\n};\r\n\r\nconst HISTORY_LIMIT = 100;\r\nconst HISTORY_TIME_GAP = 3000;\r\n\r\nconst isWindows = 'navigator' in global && /Win/i.test(navigator.platform);\r\nconst isMacLike = 'navigator' in global && /(Mac|iPhone|iPod|iPad)/i.test(navigator.platform);\r\n\r\nexport interface EditorProps {\r\n  lineNumbers: boolean;\r\n  autoStyleLineNumbers: boolean;\r\n  readonly: boolean;\r\n  value: string;\r\n  highlight: () => string;\r\n  tabSize: number;\r\n  insertSpaces: boolean;\r\n  ignoreTabKey: boolean;\r\n  placeholder: string;\r\n}\r\nexport interface Record {\r\n  value: string;\r\n  selectionStart: number;\r\n  selectionEnd: number;\r\n}\r\n\r\nexport interface History {\r\n  stack: Array<Record & { timestamp: number }>;\r\n  offset: number;\r\n}\r\ninterface AutocompleteEntry {\r\n  text: string\r\n  overlap: number\r\n  label?: string\r\n}\r\n\r\nexport const PrismEditor = Vue.extend({\r\n  props: {\r\n    lineNumbers: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    autoStyleLineNumbers: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n    readonly: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    value: {\r\n      type: String,\r\n      default: '',\r\n    },\r\n    highlight: {\r\n      type: Function,\r\n      required: true,\r\n    },\r\n    tabSize: {\r\n      type: Number,\r\n      default: 2,\r\n    },\r\n    insertSpaces: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n    ignoreTabKey: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    placeholder: {\r\n      type: String,\r\n      default: '',\r\n    },\r\n    autocomplete: {\r\n      type: Function,\r\n      default() {\r\n        return []\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      capture: true,\r\n      history: {\r\n        stack: [],\r\n        offset: -1,\r\n      } as History,\r\n      lineNumbersHeight: '20px',\r\n      codeData: '',\r\n\r\n      autocompleteOpen: false,\r\n      autocompleteIndex: 0,\r\n      autocompleteData: [] as AutocompleteEntry[]\r\n    };\r\n  },\r\n  watch: {\r\n    value: {\r\n      immediate: true,\r\n      handler(newVal: string): void {\r\n        if (!newVal) {\r\n          this.codeData = '';\r\n        } else {\r\n          this.codeData = newVal;\r\n        }\r\n      },\r\n    },\r\n    content: {\r\n      immediate: true,\r\n      handler(): void {\r\n        if (this.lineNumbers) {\r\n          this.$nextTick(() => {\r\n            this.setLineNumbersHeight();\r\n          });\r\n        }\r\n      },\r\n    },\r\n    lineNumbers(): void {\r\n      this.$nextTick(() => {\r\n        this.styleLineNumbers();\r\n        this.setLineNumbersHeight();\r\n      });\r\n    },\r\n    autocompleteIndex() {\r\n      Vue.nextTick(() => {\r\n        let node = this.$el.querySelector('ul.prism-editor__autocomplete > li.selected');\r\n        if (node) node.scrollIntoView({block: 'nearest'});\r\n      })\r\n    },\r\n  },\r\n  computed: {\r\n    isEmpty(): boolean {\r\n      return this.codeData.length === 0;\r\n    },\r\n    content(): string {\r\n      const result = this.highlight(this.codeData) + '<br />';\r\n      // todo: VNode support?\r\n      return result;\r\n    },\r\n    lineNumbersCount(): number {\r\n      const totalLines = this.codeData.split(/\\r\\n|\\n/).length;\r\n      return totalLines;\r\n    },\r\n    cursorOffset() {\r\n      let text: string = this.codeData;\r\n      let input = this.$refs.textarea as HTMLTextAreaElement;\r\n      let wrapper = this.$refs.wrapper as HTMLDivElement;\r\n      let lines = text.substring(0, input.selectionEnd || 0).split(/\\r\\n|\\n/);\r\n      let font_size = parseFloat(getComputedStyle(input).getPropertyValue('font-size'));\r\n      let line = lines.length;\r\n      let column = lines[lines.length-1].length;\r\n      return [\r\n        Math.min((column * 8.85 * (font_size / 16))    - wrapper.scrollLeft, wrapper.clientWidth - Math.min(240, wrapper.clientWidth)),\r\n        (line * 24.0 * (font_size / 16)) + 2  - wrapper.scrollTop,\r\n      ]\r\n    },\r\n  },\r\n  mounted() {\r\n    this._recordCurrentState();\r\n    this.styleLineNumbers();\r\n  },\r\n\r\n  methods: {\r\n    updateAutocompleteData() {\r\n      let input = this.$refs.textarea as HTMLTextAreaElement;\r\n      let data: AutocompleteEntry[] = typeof this.autocomplete == 'function' ? this.autocomplete(this.codeData, input.selectionEnd) : [];\r\n      let old_length = this.autocompleteData.length;\r\n      this.autocompleteData.splice(0, Infinity, ...data);\r\n      this.autocompleteOpen = true;\r\n      this.autocompleteIndex = Math.max(0, Math.min(this.autocompleteIndex, this.autocompleteData.length-1));\r\n      if (old_length > this.autocompleteData.length) this.autocompleteIndex = 0;\r\n    },\r\n    acceptAutocomplete(event: Event, option?: number) {\r\n      event.preventDefault()\r\n      if (option == undefined) option = this.autocompleteIndex;\r\n\r\n      let input = this.$refs.textarea as HTMLTextAreaElement;\r\n      let wrapper = this.$refs.wrapper as HTMLDivElement;\r\n      let suggestion = this.autocompleteData[option] || this.autocompleteData[0];\r\n      if (!suggestion) return;\r\n      \r\n      let overlap = suggestion.overlap || 0;\r\n      let new_text = [\r\n        this.codeData.substr(0, input.selectionEnd - overlap),\r\n        suggestion.text,\r\n        this.codeData.substring(input.selectionEnd),\r\n      ]\r\n      let result: string = new_text.join('');\r\n      let cursor_pos = input.selectionEnd - overlap + suggestion.text.length + (suggestion.text.endsWith(')') ? -1 : 0);\r\n      input.selectionStart = input.selectionEnd = cursor_pos;\r\n\r\n      this._applyEdits({\r\n        value: result,\r\n        selectionStart: cursor_pos,\r\n        selectionEnd: cursor_pos,\r\n      });\r\n      let inserted_characters = suggestion.text.length - suggestion.overlap;\r\n      Vue.nextTick(() => {\r\n        wrapper.scrollLeft += inserted_characters * 8.85;\r\n      })\r\n\r\n      if (suggestion.text.endsWith('.')) {\r\n        setTimeout(() => {\r\n          this.updateAutocompleteData();\r\n        }, 1);\r\n      } else {\r\n        this.autocompleteOpen = false;\r\n      }\r\n    },\r\n    setLineNumbersHeight(): void {\r\n      this.lineNumbersHeight = getComputedStyle(this.$refs.pre as HTMLTextAreaElement).height;\r\n    },\r\n    styleLineNumbers(): void {\r\n      if (!this.lineNumbers || !this.autoStyleLineNumbers) return;\r\n\r\n      const $editor = this.$refs.pre as HTMLTextAreaElement;\r\n      const $lineNumbers: HTMLDivElement | null = this.$el.querySelector('.prism-editor__line-numbers');\r\n      const editorStyles = window.getComputedStyle($editor);\r\n\r\n      this.$nextTick(() => {\r\n        const btlr: any = 'border-top-left-radius';\r\n        const bblr: any = 'border-bottom-left-radius';\r\n        if (!$lineNumbers) return;\r\n        $lineNumbers.style[btlr] = editorStyles[btlr];\r\n        $lineNumbers.style[bblr] = editorStyles[bblr];\r\n        $editor.style[btlr] = '0';\r\n        $editor.style[bblr] = '0';\r\n\r\n        const stylesList = ['background-color', 'margin-top', 'padding-top', 'font-family', 'font-size', 'line-height'];\r\n        stylesList.forEach((style: any) => {\r\n          $lineNumbers.style[style] = editorStyles[style];\r\n        });\r\n        $lineNumbers.style['margin-bottom' as any] = '-' + editorStyles['padding-top' as any];\r\n      });\r\n    },\r\n    _recordCurrentState(): void {\r\n      const input = this.$refs.textarea as HTMLTextAreaElement;\r\n\r\n      if (!input) return;\r\n      // Save current state of the input\r\n      const { value, selectionStart, selectionEnd } = input;\r\n\r\n      this._recordChange({\r\n        value,\r\n        selectionStart,\r\n        selectionEnd,\r\n      });\r\n    },\r\n    _getLines(text: string, position: number): Array<string> {\r\n      return text.substring(0, position).split('\\n');\r\n    },\r\n    _recordStateIfChange(): void {\r\n      if (this.history.stack[this.history.offset].value != this.codeData) {\r\n        this._recordChange({\r\n          value: this.codeData,\r\n          selectionStart: this.codeData.length,\r\n          selectionEnd: this.codeData.length,\r\n        });\r\n      }\r\n    },\r\n    _applyEdits(record: Record): void {\r\n      // Save last selection state\r\n      const input = this.$refs.textarea as HTMLTextAreaElement;\r\n      const last = this.history.stack[this.history.offset];\r\n\r\n      if (last && input) {\r\n        this.history.stack[this.history.offset] = {\r\n          ...last,\r\n          selectionStart: input.selectionStart,\r\n          selectionEnd: input.selectionEnd,\r\n        };\r\n      }\r\n\r\n      // Save the changes\r\n      this._recordChange(record);\r\n      this._updateInput(record);\r\n    },\r\n    _recordChange(record: Record, overwrite = false): void {\r\n      const { stack, offset } = this.history;\r\n\r\n      if (stack.length && offset > -1) {\r\n        // When something updates, drop the redo operations\r\n        this.history.stack = stack.slice(0, offset + 1);\r\n\r\n        // Limit the number of operations to 100\r\n        const count = this.history.stack.length;\r\n\r\n        if (count > HISTORY_LIMIT) {\r\n          const extras = count - HISTORY_LIMIT;\r\n\r\n          this.history.stack = stack.slice(extras, count);\r\n          this.history.offset = Math.max(this.history.offset - extras, 0);\r\n        }\r\n      }\r\n\r\n      const timestamp = Date.now();\r\n\r\n      if (overwrite) {\r\n        const last = this.history.stack[this.history.offset];\r\n\r\n        if (last && timestamp - last.timestamp < HISTORY_TIME_GAP) {\r\n          // A previous entry exists and was in short interval\r\n\r\n          // Match the last word in the line\r\n          const re = /[^a-z0-9]([a-z0-9]+)$/i;\r\n\r\n          // Get the previous line\r\n          const previous = this._getLines(last.value, last.selectionStart).pop()?.match(re);\r\n\r\n          // Get the current line\r\n          const current = this._getLines(record.value, record.selectionStart).pop()?.match(re);\r\n\r\n          if (previous && current && current[1].startsWith(previous[1])) {\r\n            // The last word of the previous line and current line match\r\n            // Overwrite previous entry so that undo will remove whole word\r\n            this.history.stack[this.history.offset] = {\r\n              ...record,\r\n              timestamp,\r\n            };\r\n\r\n            return;\r\n          }\r\n        }\r\n      }\r\n\r\n      // Add the new operation to the stack\r\n      this.history.stack.push({ ...record, timestamp });\r\n      this.history.offset++;\r\n    },\r\n\r\n    _updateInput(record: Record): void {\r\n      const input = this.$refs.textarea as HTMLTextAreaElement;\r\n\r\n      if (!input) return;\r\n\r\n      // Update values and selection state\r\n      input.value = record.value;\r\n      input.selectionStart = record.selectionStart;\r\n      input.selectionEnd = record.selectionEnd;\r\n\r\n      this.$emit('input', record.value);\r\n      // this.props.onValueChange(record.value);\r\n    },\r\n    handleChange(e: KeyboardEvent): void {\r\n      const { value, selectionStart, selectionEnd } = e.target as HTMLTextAreaElement;\r\n\r\n      this._recordChange(\r\n        {\r\n          value,\r\n          selectionStart,\r\n          selectionEnd,\r\n        },\r\n        true\r\n      );\r\n      this.$emit('input', value);\r\n      // this.props.onValueChange(value);\r\n    },\r\n    _undoEdit(): void {\r\n      const { stack, offset } = this.history;\r\n\r\n      // Get the previous edit\r\n      const record = stack[offset - 1];\r\n\r\n      if (record) {\r\n        // Apply the changes and update the offset\r\n        this._updateInput(record);\r\n        this.history.offset = Math.max(offset - 1, 0);\r\n      }\r\n    },\r\n    _redoEdit(): void {\r\n      const { stack, offset } = this.history;\r\n\r\n      // Get the next edit\r\n      const record = stack[offset + 1];\r\n\r\n      if (record) {\r\n        // Apply the changes and update the offset\r\n        this._updateInput(record);\r\n        this.history.offset = Math.min(offset + 1, stack.length - 1);\r\n      }\r\n    },\r\n    handleKeyDown(e: KeyboardEvent): void {\r\n      // console.log(navigator.platform);\r\n      const { tabSize, insertSpaces, ignoreTabKey } = this;\r\n\r\n      if (this.$listeners.keydown) {\r\n        // onKeyDown(e);\r\n        this.$emit('keydown', e);\r\n\r\n        if (e.defaultPrevented) {\r\n          return;\r\n        }\r\n      }\r\n\r\n      if (e.keyCode === 9 && this.autocompleteData.length && this.autocompleteOpen) {\r\n        this.acceptAutocomplete(e);\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        return;\r\n      }\r\n      if (e.keyCode === 27) {\r\n        // Escape\r\n        if (this.autocompleteData.length && this.autocompleteOpen) {\r\n          e.preventDefault();\r\n          this.autocompleteOpen = false;\r\n          return;\r\n        }\r\n      } else if (e.keyCode === 38) {\r\n        // Up\r\n        if (this.autocompleteData.length && this.autocompleteOpen) {\r\n          e.preventDefault();\r\n          this.autocompleteIndex = (this.autocompleteIndex ? this.autocompleteIndex : this.autocompleteData.length) - 1;\r\n          return;\r\n        }\r\n      } else if (e.keyCode === 40) {\r\n        // Down\r\n        if (this.autocompleteData.length && this.autocompleteOpen) {\r\n          e.preventDefault();\r\n          this.autocompleteIndex = (this.autocompleteIndex + 1) % this.autocompleteData.length;\r\n          return;\r\n        }\r\n      }\r\n\r\n      if (e.keyCode === KEYCODE_ESCAPE) {\r\n        (<HTMLTextAreaElement>e.target).blur();\r\n        this.$emit('blur', e);\r\n      }\r\n\r\n      const { value, selectionStart, selectionEnd } = e.target as HTMLTextAreaElement;\r\n\r\n      const tabCharacter = (insertSpaces ? ' ' : '\\t').repeat(tabSize);\r\n\r\n      if (e.keyCode === KEYCODE_TAB && !ignoreTabKey && this.capture) {\r\n        // Prevent focus change\r\n        e.preventDefault();\r\n\r\n        if (e.shiftKey) {\r\n          // Unindent selected lines\r\n          const linesBeforeCaret = this._getLines(value, selectionStart);\r\n          const startLine = linesBeforeCaret.length - 1;\r\n          const endLine = this._getLines(value, selectionEnd).length - 1;\r\n          const nextValue = value\r\n            .split('\\n')\r\n            .map((line, i) => {\r\n              if (i >= startLine && i <= endLine && line.startsWith(tabCharacter)) {\r\n                return line.substring(tabCharacter.length);\r\n              }\r\n\r\n              return line;\r\n            })\r\n            .join('\\n');\r\n\r\n          if (value !== nextValue) {\r\n            const startLineText = linesBeforeCaret[startLine];\r\n\r\n            this._applyEdits({\r\n              value: nextValue,\r\n              // Move the start cursor if first line in selection was modified\r\n              // It was modified only if it started with a tab\r\n              selectionStart: startLineText.startsWith(tabCharacter)\r\n                ? selectionStart - tabCharacter.length\r\n                : selectionStart,\r\n              // Move the end cursor by total number of characters removed\r\n              selectionEnd: selectionEnd - (value.length - nextValue.length),\r\n            });\r\n          }\r\n        } else if (selectionStart !== selectionEnd) {\r\n          // Indent selected lines\r\n          const linesBeforeCaret = this._getLines(value, selectionStart);\r\n          const startLine = linesBeforeCaret.length - 1;\r\n          const endLine = this._getLines(value, selectionEnd).length - 1;\r\n          const startLineText = linesBeforeCaret[startLine];\r\n\r\n          this._applyEdits({\r\n            value: value\r\n              .split('\\n')\r\n              .map((line, i) => {\r\n                if (i >= startLine && i <= endLine) {\r\n                  return tabCharacter + line;\r\n                }\r\n\r\n                return line;\r\n              })\r\n              .join('\\n'),\r\n            // Move the start cursor by number of characters added in first line of selection\r\n            // Don't move it if it there was no text before cursor\r\n            selectionStart: /\\S/.test(startLineText) ? selectionStart + tabCharacter.length : selectionStart,\r\n            // Move the end cursor by total number of characters added\r\n            selectionEnd: selectionEnd + tabCharacter.length * (endLine - startLine + 1),\r\n          });\r\n        } else {\r\n          const updatedSelection = selectionStart + tabCharacter.length;\r\n\r\n          this._applyEdits({\r\n            // Insert tab character at caret\r\n            value: value.substring(0, selectionStart) + tabCharacter + value.substring(selectionEnd),\r\n            // Update caret position\r\n            selectionStart: updatedSelection,\r\n            selectionEnd: updatedSelection,\r\n          });\r\n        }\r\n      } else if (e.keyCode === KEYCODE_BACKSPACE) {\r\n        const hasSelection = selectionStart !== selectionEnd;\r\n        const textBeforeCaret = value.substring(0, selectionStart);\r\n\r\n        if (textBeforeCaret.endsWith(tabCharacter) && !hasSelection) {\r\n          // Prevent default delete behaviour\r\n          e.preventDefault();\r\n\r\n          const updatedSelection = selectionStart - tabCharacter.length;\r\n\r\n          this._applyEdits({\r\n            // Remove tab character at caret\r\n            value: value.substring(0, selectionStart - tabCharacter.length) + value.substring(selectionEnd),\r\n            // Update caret position\r\n            selectionStart: updatedSelection,\r\n            selectionEnd: updatedSelection,\r\n          });\r\n        }\r\n      } else if (e.keyCode === KEYCODE_ENTER) {\r\n        \r\n        if (this.autocompleteData.length && this.autocompleteOpen) {\r\n          this.acceptAutocomplete(e);\r\n\r\n        } else if (selectionStart === selectionEnd) {\r\n          // Get the current line\r\n          const line = this._getLines(value, selectionStart).pop();\r\n          const matches = line?.match(/^\\s+/);\r\n\r\n          if (matches && matches[0]) {\r\n            e.preventDefault();\r\n\r\n            // Preserve indentation on inserting a new line\r\n            const indent = '\\n' + matches[0];\r\n            const updatedSelection = selectionStart + indent.length;\r\n\r\n            this._applyEdits({\r\n              // Insert indentation character at caret\r\n              value: value.substring(0, selectionStart) + indent + value.substring(selectionEnd),\r\n              // Update caret position\r\n              selectionStart: updatedSelection,\r\n              selectionEnd: updatedSelection,\r\n            });\r\n          }\r\n        }\r\n      } else if (BRACKET_PAIRS[e.key]) {\r\n        // If text is selected, wrap them in the characters\r\n        if (selectionStart !== selectionEnd) {\r\n          e.preventDefault();\r\n\r\n          this._applyEdits({\r\n            value:\r\n              value.substring(0, selectionStart) +\r\n              e.key +\r\n              value.substring(selectionStart, selectionEnd) +\r\n              BRACKET_PAIRS[e.key] +\r\n              value.substring(selectionEnd),\r\n            // Update caret position\r\n            selectionStart: selectionStart + 1,\r\n            selectionEnd: selectionEnd + 1,\r\n          });\r\n        }\r\n      } else if (\r\n        (isMacLike\r\n          ? // Trigger undo with ⌘+Z on Mac\r\n            e.metaKey && e.keyCode === KEYCODE_Z\r\n          : // Trigger undo with Ctrl+Z on other platforms\r\n            e.ctrlKey && e.keyCode === KEYCODE_Z) &&\r\n        !e.shiftKey &&\r\n        !e.altKey\r\n      ) {\r\n        e.preventDefault();\r\n\r\n        this._undoEdit();\r\n      } else if (\r\n        (isMacLike\r\n          ? // Trigger redo with ⌘+Shift+Z on Mac\r\n            e.metaKey && e.keyCode === KEYCODE_Z && e.shiftKey\r\n          : isWindows\r\n          ? // Trigger redo with Ctrl+Y on Windows\r\n            e.ctrlKey && e.keyCode === KEYCODE_Y\r\n          : // Trigger redo with Ctrl+Shift+Z on other platforms\r\n            e.ctrlKey && e.keyCode === KEYCODE_Z && e.shiftKey) &&\r\n        !e.altKey\r\n      ) {\r\n        e.preventDefault();\r\n\r\n        this._redoEdit();\r\n      } else if (e.keyCode === KEYCODE_M && e.ctrlKey && (isMacLike ? e.shiftKey : true)) {\r\n        e.preventDefault();\r\n\r\n        // Toggle capturing tab key so users can focus away\r\n        this.capture = !this.capture;\r\n      }\r\n      if (e.keyCode !== 13 && e.keyCode !== 9) {\r\n        setTimeout(() => {\r\n          this.updateAutocompleteData();\r\n        }, 1);\r\n      }\r\n    },\r\n  },\r\n  render(h): VNode {\r\n    const lineNumberWidthCalculator = h(\r\n      'div',\r\n      {\r\n        attrs: {\r\n          class: 'prism-editor__line-width-calc',\r\n          style: 'height: 0px; visibility: hidden; pointer-events: none;',\r\n        },\r\n      },\r\n      '999'\r\n    );\r\n    const lineNumbers = h(\r\n      'div',\r\n      {\r\n        staticClass: 'prism-editor__line-numbers',\r\n        style: {\r\n          'min-height': this.lineNumbersHeight,\r\n        },\r\n        attrs: {\r\n          'aria-hidden': 'true',\r\n        },\r\n      },\r\n      [\r\n        lineNumberWidthCalculator,\r\n        Array.from(Array(this.lineNumbersCount).keys()).map((_, index) => {\r\n          return h('div', { attrs: { class: 'prism-editor__line-number token comment' } }, `${++index}`);\r\n        }),\r\n      ]\r\n    );\r\n\r\n    const autocompleteList = (this.autocompleteOpen && this.autocompleteData.length) ? h(\r\n      'ul',\r\n      {\r\n        staticClass: 'prism-editor__autocomplete',\r\n        style: {left: this.cursorOffset[0] + 'px', top: this.cursorOffset[1] + 'px'}\r\n      },\r\n      this.autocompleteData.map((data: AutocompleteEntry, i) => {\r\n        return h('li', {\r\n          key: data.text,\r\n          class: {selected: i == this.autocompleteIndex},\r\n          on: {\r\n            mousedown: ($event: MouseEvent) => {\r\n              this.acceptAutocomplete($event, i);\r\n            }\r\n          }\r\n        }, [data.label || data.text]);\r\n      })\r\n    ) : undefined;\r\n\r\n    const textarea = h('textarea', {\r\n      ref: 'textarea',\r\n      on: {\r\n        input: this.handleChange,\r\n        keydown: this.handleKeyDown,\r\n        click: ($event: MouseEvent) => {\r\n          this.autocompleteOpen = false;\r\n          this.$emit('click', $event);\r\n        },\r\n        keyup: ($event: KeyboardEvent) => {\r\n          this.$emit('keyup', $event);\r\n        },\r\n        focus: ($event: FocusEvent) => {\r\n          this._recordStateIfChange();\r\n          this.$emit('focus', $event);\r\n        },\r\n        blur: ($event: FocusEvent) => {\r\n          this.autocompleteOpen = false;\r\n          this.$emit('blur', $event);\r\n        },\r\n      },\r\n      staticClass: 'prism-editor__textarea',\r\n      class: {\r\n        'prism-editor__textarea--empty': this.isEmpty,\r\n      },\r\n      attrs: {\r\n        spellCheck: 'false',\r\n        autocapitalize: 'off',\r\n        autocomplete: 'off',\r\n        autocorrect: 'off',\r\n        'data-gramm': 'false',\r\n        placeholder: this.placeholder,\r\n        'data-testid': 'textarea',\r\n        readonly: this.readonly,\r\n      },\r\n      domProps: {\r\n        value: this.codeData,\r\n      },\r\n    });\r\n    const preview = h('pre', {\r\n      ref: 'pre',\r\n      staticClass: 'prism-editor__editor',\r\n      attrs: {\r\n        'data-testid': 'preview',\r\n      },\r\n      domProps: {\r\n        innerHTML: this.content,\r\n      },\r\n    });\r\n    const editorContainer = h('div', { staticClass: 'prism-editor__container' }, [textarea, preview]);\r\n    const wrapper = h('div', { staticClass: 'prism-editor-wrapper', ref: 'wrapper' }, [this.lineNumbers && lineNumbers, editorContainer]);\r\n    return h('div', { staticClass: 'prism-editor-component' }, [wrapper, autocompleteList]);\r\n  },\r\n});\r\n"],"names":["KEYCODE_ENTER","KEYCODE_TAB","KEYCODE_BACKSPACE","KEYCODE_Y","KEYCODE_Z","KEYCODE_M","KEYCODE_ESCAPE","BRACKET_PAIRS","HISTORY_LIMIT","HISTORY_TIME_GAP","isWindows","global","test","navigator","platform","isMacLike","PrismEditor","Vue","extend","props","lineNumbers","type","Boolean","autoStyleLineNumbers","readonly","value","String","highlight","Function","required","tabSize","Number","insertSpaces","ignoreTabKey","placeholder","autocomplete","data","capture","history","stack","offset","lineNumbersHeight","codeData","autocompleteOpen","autocompleteIndex","autocompleteData","watch","immediate","handler","newVal","content","$nextTick","setLineNumbersHeight","styleLineNumbers","nextTick","node","$el","querySelector","scrollIntoView","block","computed","isEmpty","length","result","lineNumbersCount","totalLines","split","cursorOffset","text","input","$refs","textarea","wrapper","lines","substring","selectionEnd","font_size","parseFloat","getComputedStyle","getPropertyValue","line","column","Math","min","scrollLeft","clientWidth","scrollTop","mounted","_recordCurrentState","methods","updateAutocompleteData","old_length","splice","Infinity","max","acceptAutocomplete","event","option","preventDefault","undefined","suggestion","overlap","new_text","substr","join","cursor_pos","endsWith","selectionStart","_applyEdits","inserted_characters","setTimeout","pre","height","$editor","$lineNumbers","editorStyles","window","btlr","bblr","style","stylesList","forEach","_recordChange","_getLines","position","_recordStateIfChange","record","last","_updateInput","overwrite","slice","count","extras","timestamp","Date","now","re","previous","pop","match","current","startsWith","push","$emit","handleChange","e","target","_undoEdit","_redoEdit","handleKeyDown","$listeners","keydown","defaultPrevented","keyCode","stopPropagation","blur","tabCharacter","repeat","shiftKey","linesBeforeCaret","startLine","endLine","nextValue","map","i","startLineText","updatedSelection","hasSelection","textBeforeCaret","matches","indent","key","metaKey","ctrlKey","altKey","render","h","lineNumberWidthCalculator","attrs","staticClass","Array","from","keys","_","index","autocompleteList","left","top","selected","on","mousedown","$event","label","ref","click","keyup","focus","spellCheck","autocapitalize","autocorrect","domProps","preview","innerHTML","editorContainer"],"mappings":"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"}